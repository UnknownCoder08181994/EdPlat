FullpageScroll.prototype.bindWheel=function(){let wheelTimeout=null;let accumulated=0;let edgeGestureReady=false;let edgeGestureDir=0;let edgeGestureTimer=null;let faqCooldown=false;let faqEdgeReady=false;let faqEdgeTimer=null;window.addEventListener('wheel',(e)=>{if(this.isLocked||this.isTransitioning){e.preventDefault();return;}
const currentSection=this.sections[this.current];if(currentSection){const scrollEl=this.getScrollableChild(currentSection);if(scrollEl&&scrollEl!==currentSection){const scrollTop=scrollEl.scrollTop;const scrollHeight=scrollEl.scrollHeight;const clientHeight=scrollEl.clientHeight;const hasOverflow=scrollHeight>clientHeight+5;if(hasOverflow){const atBottom=scrollTop+clientHeight>=scrollHeight-5;const atTop=scrollTop<=5;const dir=e.deltaY>0?1:-1;if((dir===1&&atBottom)||(dir===-1&&atTop)){if(edgeGestureReady&&edgeGestureDir===dir){edgeGestureReady=false;if(edgeGestureTimer){clearTimeout(edgeGestureTimer);edgeGestureTimer=null;}}else{if(edgeGestureTimer)clearTimeout(edgeGestureTimer);edgeGestureDir=dir;edgeGestureTimer=setTimeout(()=>{edgeGestureReady=true;edgeGestureTimer=setTimeout(()=>{edgeGestureReady=false;edgeGestureTimer=null;},1500);},300);e.preventDefault();return;}}else{e.preventDefault();scrollEl.scrollTop+=e.deltaY;edgeGestureReady=false;edgeGestureDir=0;if(edgeGestureTimer){clearTimeout(edgeGestureTimer);edgeGestureTimer=null;}
return;}}}}
if(this.current===2&&window._faqCarousel){const fc=window._faqCarousel;const dir=e.deltaY>0?1:-1;const atFirst=fc.current===0;const atLast=fc.current===fc.total-1;if(dir===-1&&!atFirst){e.preventDefault();if(!faqCooldown){fc.go(fc.current-1);faqCooldown=true;setTimeout(()=>{faqCooldown=false;},400);}
faqEdgeReady=false;accumulated=0;return;}
if(dir===1&&!atLast){e.preventDefault();if(!faqCooldown){fc.go(fc.current+1);faqCooldown=true;setTimeout(()=>{faqCooldown=false;},400);}
faqEdgeReady=false;accumulated=0;return;}
if((dir===-1&&atFirst)||(dir===1&&atLast)){if(!faqEdgeReady){e.preventDefault();faqEdgeReady=true;if(faqEdgeTimer)clearTimeout(faqEdgeTimer);faqEdgeTimer=setTimeout(()=>{faqEdgeReady=false;},1500);accumulated=0;return;}
faqEdgeReady=false;if(faqEdgeTimer){clearTimeout(faqEdgeTimer);faqEdgeTimer=null;}}}
e.preventDefault();accumulated+=e.deltaY;if(wheelTimeout)clearTimeout(wheelTimeout);wheelTimeout=setTimeout(()=>{accumulated=0;},200);if(Math.abs(accumulated)>50){if(accumulated>0){this.goTo(this.current+1);}else{this.goTo(this.current-1);}
accumulated=0;}},{passive:false});};FullpageScroll.prototype.bindTouch=function(){window.addEventListener('touchstart',(e)=>{this.touchStartY=e.touches[0].clientY;this.touchStartX=e.touches[0].clientX;},{passive:true});window.addEventListener('touchend',(e)=>{if(this.isLocked||this.isTransitioning)return;const deltaY=this.touchStartY-e.changedTouches[0].clientY;const deltaX=this.touchStartX-e.changedTouches[0].clientX;if(Math.abs(deltaY)<50||Math.abs(deltaX)>Math.abs(deltaY))return;const currentSection=this.sections[this.current];if(currentSection){const scrollEl=this.getScrollableChild(currentSection);if(scrollEl&&scrollEl!==currentSection){const st=scrollEl.scrollTop;const sh=scrollEl.scrollHeight;const ch=scrollEl.clientHeight;const atTop=st<=5;const atBottom=st+ch>=sh-5;if(deltaY>0&&!atBottom)return;if(deltaY<0&&!atTop)return;}}
if(deltaY>0){this.goTo(this.current+1);}else{this.goTo(this.current-1);}},{passive:true});};FullpageScroll.prototype.bindKeyboard=function(){window.addEventListener('keydown',(e)=>{if(this.isLocked||this.isTransitioning)return;switch(e.key){case'ArrowDown':case'PageDown':case' ':e.preventDefault();this.goTo(this.current+1);break;case'ArrowUp':case'PageUp':e.preventDefault();this.goTo(this.current-1);break;case'Home':e.preventDefault();this.goTo(0);break;case'End':e.preventDefault();this.goTo(this.total-1);break;}});};FullpageScroll.prototype.bindDots=function(){};document.addEventListener('DOMContentLoaded',()=>{const fp=new FullpageScroll();window._fpInstance=fp;const homeLink=document.querySelector('[data-nav-home]');if(homeLink&&document.getElementById('fp-wrapper')){homeLink.href='#gateway';homeLink.addEventListener('click',()=>{fp.goTo(0);});}
document.querySelectorAll('[data-scroll-to]').forEach(link=>{link.addEventListener('click',(e)=>{e.preventDefault();const target=parseInt(link.dataset.scrollTo,10);fp.goTo(target);});});});