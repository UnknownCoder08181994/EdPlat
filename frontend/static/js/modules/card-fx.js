class ModulePageFX{constructor(){if(window._fxTimers){window._fxTimers.forEach(id=>clearTimeout(id));}
window._fxTimers=[];this.blocks=[{el:document.querySelector('.catalogue-hero'),isCard:false},{el:document.querySelector('.catalogue-filters-row'),isCard:false},{el:document.querySelector('.catalogue-toolbar'),isCard:false},];document.querySelectorAll('.course-card').forEach(card=>{this.blocks.push({el:card,isCard:true});});this.blocks.push({el:document.querySelector('.detail-back-link'),isCard:false});this.blocks.push({el:document.querySelector('.detail-breadcrumb'),isCard:false});this.blocks.push({el:document.querySelector('.detail-hero'),isCard:false});document.querySelectorAll('.detail-section-card').forEach(card=>{this.blocks.push({el:card,isCard:true});});this.blocks.push({el:document.querySelector('.detail-sidebar-card'),isCard:true});this.blocks.push({el:document.querySelector('.detail-topics-heading'),isCard:false});document.querySelectorAll('.detail-chapter-card').forEach(card=>{this.blocks.push({el:card,isCard:true});});this.blocks.push({el:document.querySelector('.viewer-header'),isCard:false});this.blocks.push({el:document.querySelector('.viewer-video-container'),isCard:false,isTv:true});this.blocks.push({el:document.querySelector('.viewer-timeline'),isCard:false});this.blocks.push({el:document.querySelector('.viewer-sidebar'),isCard:true});this.blocks=this.blocks.filter(b=>b.el);if(this.blocks.length===0)return;this.initEntrance();}
initEntrance(){let runningDelay=60;this.blocks.forEach(block=>{const el=block.el;const isCard=block.isCard;const myDelay=runningDelay;const isTv=block.isTv;el.classList.remove('fx-glitch','fx-tv-on','fx-text-reveal','fx-text-hidden');el.classList.add('fx-hidden');if(!isTv)el.classList.add('fx-text-hidden');window._fxTimers.push(setTimeout(()=>{el.style.opacity='';el.classList.remove('fx-hidden');void el.offsetHeight;el.classList.add(isTv?'fx-tv-on':'fx-glitch');},myDelay));if(!isTv){window._fxTimers.push(setTimeout(()=>{el.classList.remove('fx-text-hidden');el.classList.add('fx-text-reveal');},myDelay+400));}
window._fxTimers.push(setTimeout(()=>{el.classList.remove('fx-glitch','fx-tv-on','fx-text-reveal');},myDelay+850));runningDelay+=isCard?150:120;});}}
function startFX(){requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.modulePageFX=new ModulePageFX();});});}
document.addEventListener('DOMContentLoaded',startFX);window.addEventListener('pageshow',(e)=>{if(e.persisted){window.modulePageFX=new ModulePageFX();}});